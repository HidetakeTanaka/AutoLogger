{
  "file": "scripts\\script74.py",
  "candidates": [
    {
      "kind": "func_entry",
      "line": 19,
      "end_line": 19,
      "function": "is_ok",
      "class_name": "SensorReading",
      "code": "def is_ok(self, threshold: float = 0.0) -> bool:",
      "vars_in_scope": [
        "self",
        "threshold"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 20,
      "end_line": 20,
      "function": "is_ok",
      "class_name": "SensorReading",
      "code": "return False",
      "vars_in_scope": [
        "self",
        "threshold"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 21,
      "end_line": 21,
      "function": "is_ok",
      "class_name": "SensorReading",
      "code": "return self.value >= threshold",
      "vars_in_scope": [
        "self",
        "threshold"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 24,
      "end_line": 24,
      "function": "to_dict",
      "class_name": "SensorReading",
      "code": "def to_dict(self) -> Dict[str, Any]:",
      "vars_in_scope": [
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 24,
      "end_line": 24,
      "function": "to_dict",
      "class_name": "SensorReading",
      "code": "return {'timestamp': self.timestamp.isoformat(), 'value': self.value, 'status': self.status}",
      "vars_in_scope": [
        "self"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 32,
      "end_line": 32,
      "function": "from_dict",
      "class_name": "SensorReading",
      "code": "def from_dict(cls, raw: Dict[str, Any]) -> Optional[\"SensorReading\"]:",
      "vars_in_scope": [
        "cls",
        "raw",
        "ts",
        "ts_raw"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 35,
      "end_line": 35,
      "function": "from_dict",
      "class_name": "SensorReading",
      "code": "return cls(timestamp=ts, value=float(raw.get('value', 0.0)), status=str(raw.get('status', 'ok')))",
      "vars_in_scope": [
        "cls",
        "raw",
        "ts",
        "ts_raw"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "except",
      "line": 41,
      "end_line": 41,
      "function": "from_dict",
      "class_name": "SensorReading",
      "code": "except ...",
      "vars_in_scope": [
        "cls",
        "raw",
        "ts",
        "ts_raw"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 41,
      "end_line": 41,
      "function": "from_dict",
      "class_name": "SensorReading",
      "code": "return None",
      "vars_in_scope": [
        "cls",
        "raw",
        "ts",
        "ts_raw"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 51,
      "end_line": 51,
      "function": "add_reading",
      "class_name": "DeviceStatus",
      "code": "def add_reading(self, reading: SensorReading) -> None:",
      "vars_in_scope": [
        "reading",
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "func_entry",
      "line": 54,
      "end_line": 54,
      "function": "recent_readings",
      "class_name": "DeviceStatus",
      "code": "def recent_readings(self, minutes: int = 30) -> List[SensorReading]:",
      "vars_in_scope": [
        "minutes",
        "ref",
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 55,
      "end_line": 55,
      "function": "recent_readings",
      "class_name": "DeviceStatus",
      "code": "return [r for r in self.readings if r.timestamp >= ref]",
      "vars_in_scope": [
        "minutes",
        "ref",
        "self"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 58,
      "end_line": 58,
      "function": "avg_value",
      "class_name": "DeviceStatus",
      "code": "def avg_value(self, minutes: int = 60) -> float:",
      "vars_in_scope": [
        "minutes",
        "recents",
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 60,
      "end_line": 60,
      "function": "avg_value",
      "class_name": "DeviceStatus",
      "code": "return 0.0",
      "vars_in_scope": [
        "minutes",
        "recents",
        "self"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 61,
      "end_line": 61,
      "function": "avg_value",
      "class_name": "DeviceStatus",
      "code": "return sum((r.value for r in recents)) / len(recents)",
      "vars_in_scope": [
        "minutes",
        "recents",
        "self"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 64,
      "end_line": 64,
      "function": "to_dict",
      "class_name": "DeviceStatus",
      "code": "def to_dict(self) -> Dict[str, Any]:",
      "vars_in_scope": [
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 64,
      "end_line": 64,
      "function": "to_dict",
      "class_name": "DeviceStatus",
      "code": "return {'device_id': self.device_id, 'name': self.name, 'readings': [r.to_dict() for r in self.readings]}",
      "vars_in_scope": [
        "self"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 72,
      "end_line": 72,
      "function": "from_dict",
      "class_name": "DeviceStatus",
      "code": "def from_dict(cls, raw: Dict[str, Any]) -> \"DeviceStatus\":",
      "vars_in_scope": [
        "cls",
        "dev",
        "raw",
        "reading"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 80,
      "end_line": 80,
      "function": "from_dict",
      "class_name": "DeviceStatus",
      "code": "return dev",
      "vars_in_scope": [
        "cls",
        "dev",
        "raw",
        "reading"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 85,
      "end_line": 85,
      "function": "__init__",
      "class_name": "MetricsClient",
      "code": "def __init__(self, base_url: str, timeout: int = 5) -> None:",
      "vars_in_scope": [
        "base_url",
        "self",
        "timeout"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "func_entry",
      "line": 89,
      "end_line": 89,
      "function": "_url",
      "class_name": "MetricsClient",
      "code": "def _url(self, path: str) -> str:",
      "vars_in_scope": [
        "path",
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 89,
      "end_line": 89,
      "function": "_url",
      "class_name": "MetricsClient",
      "code": "return f\"{self.base_url}/{path.lstrip('/')}\"",
      "vars_in_scope": [
        "path",
        "self"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 92,
      "end_line": 92,
      "function": "fetch_thresholds",
      "class_name": "MetricsClient",
      "code": "def fetch_thresholds(self) -> Optional[Dict[str, float]]:",
      "vars_in_scope": [
        "data",
        "req",
        "self",
        "url"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 93,
      "end_line": 93,
      "function": "fetch_thresholds",
      "class_name": "MetricsClient",
      "code": "return None",
      "vars_in_scope": [
        "data",
        "req",
        "self",
        "url"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 99,
      "end_line": 99,
      "function": "fetch_thresholds",
      "class_name": "MetricsClient",
      "code": "return json.loads(data.decode('utf-8'))",
      "vars_in_scope": [
        "data",
        "req",
        "self",
        "url"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "except",
      "line": 101,
      "end_line": 101,
      "function": "fetch_thresholds",
      "class_name": "MetricsClient",
      "code": "except ...",
      "vars_in_scope": [
        "data",
        "req",
        "self",
        "url"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 101,
      "end_line": 101,
      "function": "fetch_thresholds",
      "class_name": "MetricsClient",
      "code": "return None",
      "vars_in_scope": [
        "data",
        "req",
        "self",
        "url"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 104,
      "end_line": 104,
      "function": "push_summary",
      "class_name": "MetricsClient",
      "code": "def push_summary(self, summary: Dict[str, Any]) -> bool:",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 105,
      "end_line": 105,
      "function": "push_summary",
      "class_name": "MetricsClient",
      "code": "return False",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 112,
      "end_line": 112,
      "function": "push_summary",
      "class_name": "MetricsClient",
      "code": "return 200 <= resp.status < 300",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "except",
      "line": 114,
      "end_line": 114,
      "function": "push_summary",
      "class_name": "MetricsClient",
      "code": "except ...",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 114,
      "end_line": 114,
      "function": "push_summary",
      "class_name": "MetricsClient",
      "code": "return False",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "except",
      "line": 116,
      "end_line": 116,
      "function": "push_summary",
      "class_name": "MetricsClient",
      "code": "except ...",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 116,
      "end_line": 116,
      "function": "push_summary",
      "class_name": "MetricsClient",
      "code": "return False",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 120,
      "end_line": 120,
      "function": "load_devices",
      "class_name": null,
      "code": "def load_devices(path: Path) -> List[DeviceStatus]:",
      "vars_in_scope": [
        "path",
        "raw"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 122,
      "end_line": 122,
      "function": "load_devices",
      "class_name": null,
      "code": "return [DeviceStatus.from_dict(d) for d in raw]",
      "vars_in_scope": [
        "path",
        "raw"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "except",
      "line": 124,
      "end_line": 124,
      "function": "load_devices",
      "class_name": null,
      "code": "except ...",
      "vars_in_scope": [
        "path",
        "raw"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 124,
      "end_line": 124,
      "function": "load_devices",
      "class_name": null,
      "code": "return []",
      "vars_in_scope": [
        "path",
        "raw"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "except",
      "line": 126,
      "end_line": 126,
      "function": "load_devices",
      "class_name": null,
      "code": "except ...",
      "vars_in_scope": [
        "path",
        "raw"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 126,
      "end_line": 126,
      "function": "load_devices",
      "class_name": null,
      "code": "return []",
      "vars_in_scope": [
        "path",
        "raw"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 130,
      "end_line": 130,
      "function": "save_devices",
      "class_name": null,
      "code": "def save_devices(path: Path, devices: List[DeviceStatus]) -> None:",
      "vars_in_scope": [
        "devices",
        "path",
        "payload",
        "tmp"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "except",
      "line": 136,
      "end_line": 136,
      "function": "save_devices",
      "class_name": null,
      "code": "except ...",
      "vars_in_scope": [
        "devices",
        "path",
        "payload",
        "tmp"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "except",
      "line": 140,
      "end_line": 140,
      "function": "save_devices",
      "class_name": null,
      "code": "except ...",
      "vars_in_scope": [
        "devices",
        "path",
        "payload",
        "tmp"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 140,
      "end_line": 140,
      "function": "save_devices",
      "class_name": null,
      "code": "return",
      "vars_in_scope": [
        "devices",
        "path",
        "payload",
        "tmp"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 144,
      "end_line": 144,
      "function": "summarize_devices",
      "class_name": null,
      "code": "def summarize_devices(devices: List[DeviceStatus]) -> Dict[str, Any]:",
      "vars_in_scope": [
        "avg_values",
        "devices",
        "overall_avg",
        "overall_vals"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 145,
      "end_line": 145,
      "function": "summarize_devices",
      "class_name": null,
      "code": "return {'count': 0, 'avg_values': {}, 'overall_avg': 0.0}",
      "vars_in_scope": [
        "avg_values",
        "devices",
        "overall_avg",
        "overall_vals"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 152,
      "end_line": 152,
      "function": "summarize_devices",
      "class_name": null,
      "code": "return {'count': len(devices), 'avg_values': avg_values, 'overall_avg': overall_avg}",
      "vars_in_scope": [
        "avg_values",
        "devices",
        "overall_avg",
        "overall_vals"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 162,
      "end_line": 162,
      "function": "detect_anomalies",
      "class_name": null,
      "code": "def detect_anomalies(",
      "vars_in_scope": [
        "devices",
        "incidents",
        "limit",
        "thresholds"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 163,
      "end_line": 163,
      "function": "detect_anomalies",
      "class_name": null,
      "code": "return []",
      "vars_in_scope": [
        "devices",
        "incidents",
        "limit",
        "thresholds"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 169,
      "end_line": 169,
      "function": "detect_anomalies",
      "class_name": null,
      "code": "return incidents",
      "vars_in_scope": [
        "devices",
        "incidents",
        "limit",
        "thresholds"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 173,
      "end_line": 173,
      "function": "simulate_cycle",
      "class_name": null,
      "code": "def simulate_cycle(devices: List[DeviceStatus], cycles: int = 3) -> None:",
      "vars_in_scope": [
        "base",
        "cycles",
        "devices",
        "jitter",
        "status",
        "step",
        "value"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 174,
      "end_line": 174,
      "function": "simulate_cycle",
      "class_name": null,
      "code": "return",
      "vars_in_scope": [
        "base",
        "cycles",
        "devices",
        "jitter",
        "status",
        "step",
        "value"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 187,
      "end_line": 187,
      "function": "main",
      "class_name": null,
      "code": "def main(data_dir: str = \"data\", base_url: str = \"\") -> int:",
      "vars_in_scope": [
        "base",
        "base_url",
        "client",
        "data_dir",
        "devices",
        "incidents",
        "output_path",
        "pushed",
        "store_path",
        "summary",
        "thresholds"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "except",
      "line": 207,
      "end_line": 207,
      "function": "main",
      "class_name": null,
      "code": "except ...",
      "vars_in_scope": [
        "base",
        "base_url",
        "client",
        "data_dir",
        "devices",
        "incidents",
        "output_path",
        "pushed",
        "store_path",
        "summary",
        "thresholds"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 207,
      "end_line": 207,
      "function": "main",
      "class_name": null,
      "code": "return 1",
      "vars_in_scope": [
        "base",
        "base_url",
        "client",
        "data_dir",
        "devices",
        "incidents",
        "output_path",
        "pushed",
        "store_path",
        "summary",
        "thresholds"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 210,
      "end_line": 210,
      "function": "main",
      "class_name": null,
      "code": "return 1",
      "vars_in_scope": [
        "base",
        "base_url",
        "client",
        "data_dir",
        "devices",
        "incidents",
        "output_path",
        "pushed",
        "store_path",
        "summary",
        "thresholds"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 211,
      "end_line": 211,
      "function": "main",
      "class_name": null,
      "code": "return 0",
      "vars_in_scope": [
        "base",
        "base_url",
        "client",
        "data_dir",
        "devices",
        "incidents",
        "output_path",
        "pushed",
        "store_path",
        "summary",
        "thresholds"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    }
  ]
}