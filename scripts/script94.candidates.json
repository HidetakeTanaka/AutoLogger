{
  "file": "scripts\\script94.py",
  "candidates": [
    {
      "kind": "func_entry",
      "line": 18,
      "end_line": 18,
      "function": "is_recent",
      "class_name": "SensorReading",
      "code": "def is_recent(self, minutes: int = 60) -> bool:",
      "vars_in_scope": [
        "minutes",
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 18,
      "end_line": 18,
      "function": "is_recent",
      "class_name": "SensorReading",
      "code": "return self.recorded_at >= datetime.utcnow() - timedelta(minutes=minutes)",
      "vars_in_scope": [
        "minutes",
        "self"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 21,
      "end_line": 21,
      "function": "to_dict",
      "class_name": "SensorReading",
      "code": "def to_dict(self) -> Dict[str, Any]:",
      "vars_in_scope": [
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 21,
      "end_line": 21,
      "function": "to_dict",
      "class_name": "SensorReading",
      "code": "return {'device_id': self.device_id, 'metric': self.metric, 'value': self.value, 'recorded_at': self.recorded_at.isoformat(), 'tags': list(self.tags)}",
      "vars_in_scope": [
        "self"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 31,
      "end_line": 31,
      "function": "from_dict",
      "class_name": "SensorReading",
      "code": "def from_dict(cls, raw: Dict[str, Any]) -> Optional[\"SensorReading\"]:",
      "vars_in_scope": [
        "cls",
        "raw",
        "ts",
        "ts_raw"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 34,
      "end_line": 34,
      "function": "from_dict",
      "class_name": "SensorReading",
      "code": "return cls(str(raw.get('device_id', '')), str(raw.get('metric', '')), float(raw.get('value', 0.0)), ts, list(raw.get('tags', [])))",
      "vars_in_scope": [
        "cls",
        "raw",
        "ts",
        "ts_raw"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "except",
      "line": 42,
      "end_line": 42,
      "function": "from_dict",
      "class_name": "SensorReading",
      "code": "except ...",
      "vars_in_scope": [
        "cls",
        "raw",
        "ts",
        "ts_raw"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 42,
      "end_line": 42,
      "function": "from_dict",
      "class_name": "SensorReading",
      "code": "return None",
      "vars_in_scope": [
        "cls",
        "raw",
        "ts",
        "ts_raw"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 53,
      "end_line": 53,
      "function": "add_reading",
      "class_name": "DeviceState",
      "code": "def add_reading(self, reading: SensorReading) -> None:",
      "vars_in_scope": [
        "reading",
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "func_entry",
      "line": 57,
      "end_line": 57,
      "function": "needs_refresh",
      "class_name": "DeviceState",
      "code": "def needs_refresh(self, hours: int = 24) -> bool:",
      "vars_in_scope": [
        "hours",
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 57,
      "end_line": 57,
      "function": "needs_refresh",
      "class_name": "DeviceState",
      "code": "return self.updated_at < datetime.utcnow() - timedelta(hours=hours)",
      "vars_in_scope": [
        "hours",
        "self"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 60,
      "end_line": 60,
      "function": "daily_average",
      "class_name": "DeviceState",
      "code": "def daily_average(self, day: date, metric: str) -> Optional[float]:",
      "vars_in_scope": [
        "day",
        "metric",
        "self",
        "vals"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 65,
      "end_line": 65,
      "function": "daily_average",
      "class_name": "DeviceState",
      "code": "return sum(vals) / len(vals) if vals else None",
      "vars_in_scope": [
        "day",
        "metric",
        "self",
        "vals"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 68,
      "end_line": 68,
      "function": "to_dict",
      "class_name": "DeviceState",
      "code": "def to_dict(self) -> Dict[str, Any]:",
      "vars_in_scope": [
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 68,
      "end_line": 68,
      "function": "to_dict",
      "class_name": "DeviceState",
      "code": "return {'device_id': self.device_id, 'threshold': self.threshold, 'updated_at': self.updated_at.isoformat(), 'readings': [r.to_dict() for r in self.readings]}",
      "vars_in_scope": [
        "self"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 77,
      "end_line": 77,
      "function": "from_dict",
      "class_name": "DeviceState",
      "code": "def from_dict(cls, raw: Dict[str, Any]) -> \"DeviceState\":",
      "vars_in_scope": [
        "cls",
        "r",
        "raw",
        "state",
        "ts",
        "ts_raw"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "except",
      "line": 81,
      "end_line": 81,
      "function": "from_dict",
      "class_name": "DeviceState",
      "code": "except ...",
      "vars_in_scope": [
        "cls",
        "r",
        "raw",
        "state",
        "ts",
        "ts_raw"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 91,
      "end_line": 91,
      "function": "from_dict",
      "class_name": "DeviceState",
      "code": "return state",
      "vars_in_scope": [
        "cls",
        "r",
        "raw",
        "state",
        "ts",
        "ts_raw"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 96,
      "end_line": 96,
      "function": "__init__",
      "class_name": "TelemetryClient",
      "code": "def __init__(self, base_url: str, timeout: int = 5) -> None:",
      "vars_in_scope": [
        "base_url",
        "self",
        "timeout"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "func_entry",
      "line": 99,
      "end_line": 99,
      "function": "_url",
      "class_name": "TelemetryClient",
      "code": "def _url(self, path: str) -> str:",
      "vars_in_scope": [
        "path",
        "self"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 99,
      "end_line": 99,
      "function": "_url",
      "class_name": "TelemetryClient",
      "code": "return f\"{self.base_url}/{path.lstrip('/')}\" if self.base_url else ''",
      "vars_in_scope": [
        "path",
        "self"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 102,
      "end_line": 102,
      "function": "fetch_remote_threshold",
      "class_name": "TelemetryClient",
      "code": "def fetch_remote_threshold(self, device_id: str) -> Optional[float]:",
      "vars_in_scope": [
        "data",
        "device_id",
        "req",
        "self",
        "url",
        "val"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 104,
      "end_line": 104,
      "function": "fetch_remote_threshold",
      "class_name": "TelemetryClient",
      "code": "return None",
      "vars_in_scope": [
        "data",
        "device_id",
        "req",
        "self",
        "url",
        "val"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 110,
      "end_line": 110,
      "function": "fetch_remote_threshold",
      "class_name": "TelemetryClient",
      "code": "return float(val) if val is not None else None",
      "vars_in_scope": [
        "data",
        "device_id",
        "req",
        "self",
        "url",
        "val"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "except",
      "line": 112,
      "end_line": 112,
      "function": "fetch_remote_threshold",
      "class_name": "TelemetryClient",
      "code": "except ...",
      "vars_in_scope": [
        "data",
        "device_id",
        "req",
        "self",
        "url",
        "val"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 112,
      "end_line": 112,
      "function": "fetch_remote_threshold",
      "class_name": "TelemetryClient",
      "code": "return None",
      "vars_in_scope": [
        "data",
        "device_id",
        "req",
        "self",
        "url",
        "val"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 115,
      "end_line": 115,
      "function": "push_summary",
      "class_name": "TelemetryClient",
      "code": "def push_summary(self, summary: Dict[str, Any]) -> bool:",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 117,
      "end_line": 117,
      "function": "push_summary",
      "class_name": "TelemetryClient",
      "code": "return False",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 127,
      "end_line": 127,
      "function": "push_summary",
      "class_name": "TelemetryClient",
      "code": "return 200 <= resp.status < 300",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "except",
      "line": 129,
      "end_line": 129,
      "function": "push_summary",
      "class_name": "TelemetryClient",
      "code": "except ...",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 129,
      "end_line": 129,
      "function": "push_summary",
      "class_name": "TelemetryClient",
      "code": "return False",
      "vars_in_scope": [
        "body",
        "req",
        "self",
        "summary",
        "url"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 133,
      "end_line": 133,
      "function": "load_state",
      "class_name": null,
      "code": "def load_state(path: Path) -> DeviceState:",
      "vars_in_scope": [
        "path",
        "raw"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 134,
      "end_line": 134,
      "function": "load_state",
      "class_name": null,
      "code": "return DeviceState(device_id='local')",
      "vars_in_scope": [
        "path",
        "raw"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 137,
      "end_line": 137,
      "function": "load_state",
      "class_name": null,
      "code": "return DeviceState.from_dict(raw)",
      "vars_in_scope": [
        "path",
        "raw"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "except",
      "line": 139,
      "end_line": 139,
      "function": "load_state",
      "class_name": null,
      "code": "except ...",
      "vars_in_scope": [
        "path",
        "raw"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 139,
      "end_line": 139,
      "function": "load_state",
      "class_name": null,
      "code": "return DeviceState(device_id='local')",
      "vars_in_scope": [
        "path",
        "raw"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 143,
      "end_line": 143,
      "function": "save_state",
      "class_name": null,
      "code": "def save_state(path: Path, state: DeviceState) -> None:",
      "vars_in_scope": [
        "path",
        "payload",
        "state",
        "tmp"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "except",
      "line": 150,
      "end_line": 150,
      "function": "save_state",
      "class_name": null,
      "code": "except ...",
      "vars_in_scope": [
        "path",
        "payload",
        "state",
        "tmp"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 150,
      "end_line": 150,
      "function": "save_state",
      "class_name": null,
      "code": "return",
      "vars_in_scope": [
        "path",
        "payload",
        "state",
        "tmp"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 154,
      "end_line": 154,
      "function": "compute_stats",
      "class_name": null,
      "code": "def compute_stats(state: DeviceState) -> Dict[str, Any]:",
      "vars_in_scope": [
        "avg",
        "metrics",
        "over",
        "state"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 155,
      "end_line": 155,
      "function": "compute_stats",
      "class_name": null,
      "code": "return {'count': 0, 'over_threshold': 0, 'metrics': {}}",
      "vars_in_scope": [
        "avg",
        "metrics",
        "over",
        "state"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 163,
      "end_line": 163,
      "function": "compute_stats",
      "class_name": null,
      "code": "return {'count': len(state.readings), 'over_threshold': over, 'metrics': avg}",
      "vars_in_scope": [
        "avg",
        "metrics",
        "over",
        "state"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 167,
      "end_line": 167,
      "function": "simulate_readings",
      "class_name": null,
      "code": "def simulate_readings(state: DeviceState, hours: int = 12) -> int:",
      "vars_in_scope": [
        "created",
        "h",
        "hours",
        "metrics",
        "now",
        "state",
        "ts",
        "val"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 182,
      "end_line": 182,
      "function": "simulate_readings",
      "class_name": null,
      "code": "return created",
      "vars_in_scope": [
        "created",
        "h",
        "hours",
        "metrics",
        "now",
        "state",
        "ts",
        "val"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 186,
      "end_line": 186,
      "function": "summarize_state",
      "class_name": null,
      "code": "def summarize_state(state: DeviceState, remote_threshold: Optional[float]) -> Dict[str, Any]:",
      "vars_in_scope": [
        "remote_threshold",
        "state",
        "stats"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "before_return",
      "line": 189,
      "end_line": 189,
      "function": "summarize_state",
      "class_name": null,
      "code": "return {'device_id': state.device_id, 'threshold': state.threshold, 'count': stats['count'], 'over_threshold': stats['over_threshold'], 'metrics': stats['metrics']}",
      "vars_in_scope": [
        "remote_threshold",
        "state",
        "stats"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "func_entry",
      "line": 199,
      "end_line": 199,
      "function": "main",
      "class_name": null,
      "code": "def main(data_dir: str = \"data\", base_url: str = \"\") -> int:",
      "vars_in_scope": [
        "base",
        "base_url",
        "client",
        "data_dir",
        "remote",
        "state",
        "summary"
      ],
      "why": "function entry",
      "severity_hint": "DEBUG"
    },
    {
      "kind": "except",
      "line": 214,
      "end_line": 214,
      "function": "main",
      "class_name": null,
      "code": "except ...",
      "vars_in_scope": [
        "base",
        "base_url",
        "client",
        "data_dir",
        "remote",
        "state",
        "summary"
      ],
      "why": "inside except",
      "severity_hint": "ERROR"
    },
    {
      "kind": "before_return",
      "line": 214,
      "end_line": 214,
      "function": "main",
      "class_name": null,
      "code": "return 1",
      "vars_in_scope": [
        "base",
        "base_url",
        "client",
        "data_dir",
        "remote",
        "state",
        "summary"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    },
    {
      "kind": "before_return",
      "line": 215,
      "end_line": 215,
      "function": "main",
      "class_name": null,
      "code": "return 0",
      "vars_in_scope": [
        "base",
        "base_url",
        "client",
        "data_dir",
        "remote",
        "state",
        "summary"
      ],
      "why": "before return",
      "severity_hint": "INFO"
    }
  ]
}